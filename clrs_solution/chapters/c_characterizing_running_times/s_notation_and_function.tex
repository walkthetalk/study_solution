\startsection[
  reference={section:notationfunction},
  title={Standard notations and common functions},
]

%e3.3-1
\startEXERCISE
如果 \m{f(n)} 和 \m{g(n)} 均單調遞增，證明函式 \m{f(n) + g(n)} 和 \m{f(g(n))} 也都單調遞增。
另外，如果 \m{f(n)} 和 \m{g(n)} 均非負，則 \m{f(n)\cdot g(n)} 也單調遞增。
\stopEXERCISE
\startANSWER
\m{f(n)} 和 \m{g(n)} 均單調遞增，則：
\startformula\startalign
 \NC f(m) \leq f(n) \NC \quad \text{若 } m \leq n \NR
 \NC g(m) \leq f(n) \NC \quad \text{若 } m \leq n \NR
\stopalign\stopformula
兩式相加得：
\startformula
f(m) + g(m) \leq f(n) + g(n)
\stopformula
即 \m{f(n) + g(n)} 單調遞增。

而
\startformula\startalign
 \NC m \NC \leq n \NR
\NC g(m) \NC \leq g(n) \NR
\NC f(g(m)) \NC \leq f(g(n)) \NR
\stopalign\stopformula
，所以 \m{f(g(n))} 也單調遞增。

由於 \m{f(n)} 和 \m{g(n)} 均非負，兩式直接相乘：
\startformula
f(m) \cdot g(m) \leq f(n) \cdot g(n)
\stopformula
\stopANSWER

%e3.3-2
\startEXERCISE
證明：
對於任意整數 $n$ 和實數 $\alpha$ （$0\le \alpha\le 1$），
下式成立：
\startformula
\lfloor\alpha n\rfloor + \lceil(1-\alpha) n\rceil = n
\stopformula
\stopEXERCISE
\startANSWER
令 $\alpha n = i + r$，
其中 $i = \lfloor\alpha n\rfloor$， $0\le r< 1$。
則：
\startformula\startalign
\NC \lfloor \alpha n \rfloor \NC = i \NR
\NC \lceil(1-\alpha) n\rceil \NC = \lceil n - (i+r)\rceil \NR
\NC \NC = \lceil n - i - r \rceil \NR
\NC \NC = n - i \NR
\stopalign\stopformula
因此：
\startformula
\lfloor\alpha n\rfloor + \lceil(1-\alpha) n\rceil = i + (n-i) = n
\stopformula
\stopANSWER

%e3.3-3
\startEXERCISE[exercise:floorceil_theta]
利用式（3.14）或其他方式證明，對於任意實數 $k$，下式成立：
\startformula
(n+o(n))^k = \Theta(n^k)
\stopformula
同時證明 $\lceil n\rceil^k = \Theta(n^k)$ 和 $\lfloor n\rfloor^k = \Theta(n^k)$。
\stopEXERCISE
\startANSWER
提示：
\startformula
\NC (n+o(n))^k \NC = (n(1+\frac{o(n)}{n}))^k \NR
\NC \NC = n^k (1+\frac{o(n)}{n})^k \NR
\NC \NC \ge n^k (1 + c)^k \NR
\stopformula
\stopANSWER

%e3.3-4
\startEXERCISE[exercise:lg_n_fac]
證明：
\startigBase[a]
%item a
\startitem
$a^{\log_b^c} = c^{\log_b^a}$ \hfill (3.21)

\startANSWER
\startformula
a^{\log_b^c} = b^{\log_b^{a^{\log_b^c}}}
= b^{\log_b^c \cdot \log_b^a}
= c^{\log_b^a}
\stopformula
\stopANSWER
\stopitem

%item b
\startitem
$n!=o(n^n)$ \hfill (3.26)

\startANSWER
$f(n)=n!$， $g(n)=n^n$，
對於任意 $c>0$，
令 $n \ge n_0 = \max(\lceil 1/c\rceil, 2)$，
則 $c\cdot n > 1$，有：
\startformula\startmathalignment
\NC 0\le f(n) \NC
< 1 \cdot \underbrace{n \cdot n \cdot \cdots \cdot n}_{\text{$n-1$ 個}} \NR
\NC \NC < (c\cdot n) \cdot \underbrace{n \cdot n \cdot \cdots \cdot n}_{\text{$n-1$ 個}} \NR
\NC \NC < c \cdot \underbrace{n \cdot n \cdot \cdots \cdot n}_{\text{n 個}} \NR
\NC \NC = c n^n \NR
\NC \NC = c g(n) \NR
\stopmathalignment\stopformula
\stopANSWER

$n!=\omega(2^n)$ \hfill (3.27)

\startANSWER
$f(n)=n!$， $g(n)=2^n$，
對於任意 $c>0$，
令 $n \ge n_0 = \max(\lceil 2c \rceil, 2)$，
則：
\startformula\startmathalignment
\NC 0 \le c g(n) \NC
= (2c) \cdot \underbrace{2 \cdot 2 \cdot \cdots \cdot 2}_{\text{$n-1$ 個}} \NR
\NC \NC < n 2^{n-1} \NR
\NC \NC < 2 \cdot 2^{n-1} \NR
\NC \NC = 2^n \NR
\NC \NC = f(n) \NR
\stopmathalignment\stopformula
\stopANSWER

$\lg(n!)=\Theta(n\lg n)$ \hfill (3.28)

\startANSWER
根據（3.27）我們已知 $\lg(n!)=O(n\lg n)$，
接下來我們只須證明 $\lg(n!)=\Omega(n\lg n)$ 即可。
\startformula\startmathalignment
\NC \lg n! \NC = \sum_{i=1}^{n}\lg i \NR
\NC \NC \ge \sum_{i = \lceil n/2 \rceil}^{n}\lg i \NR
\NC \NC \ge \sum_{i = \lceil n/2 \rceil}^{n} \lg \frac{2}{n} \NR
\NC \NC \ge \frac{n}{2}\lg \frac{n}{2} \NR
\NC \NC = \frac{n}{2}(\lg n - 1) \NR
\NC \NC = \Omega(n\lg n) \NR
\stopmathalignment\stopformula
\stopANSWER
\stopitem

%item c
\startitem
$\lg(\Theta(n)) = \Theta(\lg n)$。

\startANSWER
\startformula\startmathalignment[n=3,align={right,middle,left}]
\NC c_1 n \le \NC \Theta(n) \NC \le c_2 n \NR
\NC \lg(c_1 n) \le \NC \lg(\Theta(n)) \NC \le \lg(c_2 n) \NR
\NC \lg c_1 + \lg n \le \NC \lg(\Theta(n)) \NC \le \lg c_2 + \lg n \NR
\stopmathalignment\stopformula
\stopANSWER
\stopitem
\stopigBase
\stopEXERCISE

%e3.3-5
\startEXERCISE\DIFFICULT
函式 \m{\lceil \lg{n} \rceil!} 多項式有界嗎？
函式 \m{\lceil \lg{\lg{n}} \rceil!} 多項式有界嗎？
\stopEXERCISE
\startANSWER
多項式有界的定義：
\startformula
 f(n) \leq c n^k
\stopformula
兩邊同時取對數：
\startformula
 \lg f(n) \leq c_1 k \lg n
\stopformula
即如果 \m{\lg f(n) = \Theta(\lg n)}，則函式 \m{f(n)} 多項式有界。

令 \m{f(n) = \lceil \lg{n} \rceil!}， \m{m = \lceil \lg{n} \rceil}，由上個練習可得：
\startformula\startalign
 \NC \lg f(n) \NC = \lg \lceil\lg{n}\rceil ! \NR
 \NC          \NC = \lg m! \NR
 \NC          \NC = \Theta(m\lg m) \NR
 \NC          \NC = \Theta(\lceil\lg n\rceil \lg \lceil \lg n\rceil) \NR
 \NC          \NC \neq \Theta(\lg n) \NR
\stopalign\stopformula
所以 \m{\lceil \lg{n} \rceil!} \emph{不是}多項式有界的。

對於另外一個，
設 \m{f(n) = \lceil \lg{\lg{n}} \rceil!}， \m{p = \lceil \lg{\lg{n}} \rceil}，
由上個練習可得：
\startformula\startalign
 \NC \lg f(n) \NC = \lg \lceil\lg{\lg{n}}\rceil ! \NR
 \NC          \NC = \lg p! \NR
 \NC          \NC = \Theta(p\lg p) \NR
 \NC          \NC = \Theta(\lceil\lg\lg n\rceil \lg \lceil \lg\lg n\rceil) \NR
 \NC          \NC = \Theta(\lg\lg n \cdot \lg\lg\lg n) \NR
 \NC          \NC = o(\lg\lg n \cdot \lg\lg n) \NR
 \NC          \NC = o(\lg^2\lg n) \NR
 \NC          \NC = o(\lg n) \NR
\stopalign\stopformula
所以 \m{\lceil \lg\lg{n} \rceil!} \emph{是}多項式有界的。
\stopANSWER

%e3.3-6
\startEXERCISE\DIFFICULT
\m{\lg(\lg^*n)} 和 \m{\lg^*(\lg n)} 哪個漸進更大？
\stopEXERCISE
\startANSWER
後者：
\startformula
\lg^*(\lg{n}) = \lg^*n - 1 > \lg(\lg^*(n))
\stopformula
\stopANSWER

%e3.2-7
\startEXERCISE
證明黃金比例 $\phi$ 及其共扼 $\hat \phi$ 均滿足方程 \m{x^2 = x + 1}。
\stopEXERCISE
\startANSWER
\startformula\startalign
 \NC \phi^2 - \phi - 1
     \NC = (\frac{1 + \sqrt5}{2})^2 - \frac{1 + \sqrt5}{2} - 1 \NR
 \NC \NC = \frac{1 + 2\sqrt{5} + 5 - 2 - 2\sqrt{5} - 4}{4} \NR
 \NC \NC = 0 \NR
\stopalign\stopformula

\startformula\startalign
 \NC \hat\phi^2 - \hat\phi - 1
     \NC = (\frac{1 - \sqrt5}{2})^2 - \frac{1 - \sqrt5}{2} - 1 \NR
 \NC \NC = \frac{1 - 2\sqrt{5} + 5 - 2 + 2\sqrt{5} - 4}{4} \NR
 \NC \NC = 0 \NR
\stopalign\stopformula
\stopANSWER

%e3.2-8
\startEXERCISE
證明第 \m{i} 個 Fibonacci 數滿足方程：
\startformula
F_i = \frac{\phi^{i} - \hat{\phi^{i}}}{\sqrt 5}
\stopformula
其中 $\phi$ 是黃金比例，而 $\hat \phi$ 是其共軛
\stopEXERCISE
\startANSWER
初始：
\startformula\startalign
\NC \frac{\phi^0 - \hat\phi^0}{\sqrt{5}}
    \NC = \frac{1 - 1}{\sqrt{5}} = 0 = F_0 \NR
\NC \frac{\phi - \hat{\phi}}{\sqrt{5}}
    \NC = \frac{1 + \sqrt{5} - 1 + \sqrt{5}}{2\sqrt{5}} = 1 = F_1 \NR
\stopalign\stopformula
歸納：
\startformula\startalign
 \NC F_{n + 2} \NC = F_{n + 1} + F_n \NR
 \NC \NC = \frac{\phi^{n+1} - {\hat\phi}^{n+1}}{\sqrt{5}} + \frac{\phi^n - {\hat\phi}^n}{\sqrt{5}} \NR
 \NC \NC = \frac{\phi^n(\phi + 1) - {\hat\phi}^n(\hat\phi + 1)}{\sqrt{5}} \NR
 \NC \NC = \frac{\phi^n\phi^2 - {\hat\phi}^n{\hat\phi}^2}{\sqrt{5}} \NR
 \NC \NC = \frac{\phi^{n+2} - {\hat\phi}^{n+2}}{\sqrt{5}} \NR
\stopalign\stopformula
\stopANSWER

%e3.2-9
\startEXERCISE
證明 $k\lg k = \Theta(n)$ 蘊含着 $k = \Theta(n/\lg n)$。
\stopEXERCISE
\startANSWER
由 $\Theta$ 的對稱性可知：
\startformula
k\lg{k} = \Theta(n) \Rightarrow n = \Theta(k\lg{k})
\stopformula
則：
\startformula\startmathalignment
\NC \lg{n}
    \NC = \Theta(\lg(k\lg{k})) \NR
\NC \NC = \Theta(\lg{k} + \lg\lg{k}) \NR
\NC \NC = \Theta(\lg{k}) \NR
\stopmathalignment\stopformula
兩式相除：
\startformula
\frac{n}{\lg{n}}
  = \frac{\Theta(k\lg{k})}{\Theta(\lg{k})}
  = \Theta(\frac{k\lg{k}}{\lg{k}})
  = \Theta(k)
\stopformula
\stopANSWER

\stopsection
